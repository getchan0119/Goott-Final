<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns:https="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <title>회원가입</title>
  <link rel="stylesheet" href="/assets/css/signupstyle.css">
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

  <!-- partial -->
  <!--<script src="js/signupscript.js"></script>-->
<style>

  .typing-txt{display: none;}
  ul{list-style:none;}
  .typing ul li.on {
    display: inline-block;
    animation-name: cursor;
    animation-duration: 0.3s;
    animation-iteration-count: infinite;
  }
  @keyframes cursor{
    0%{border-right: 1px solid #fff}
    50%{border-right: 1px solid #000}
    100%{border-right: 1px solid #fff}
  }

  /*가방 손잡이 CSS*/

  #lock {


    font-size: 8px;
    position: absolute;
    width: 18em;
    height: 30em;
    border-radius: 2em;

    box-sizing: border-box;
    border: 3.5em solid #2f4f4f;
    border-right-width: 3em;
    border-left-width: 3em;
    margin: 0 0 0 0;



    #lock:before {

      content: "";
      box-sizing: border-box;
      position: absolute;
      border: 2.5em solid #2f4f4f;


      border-top-left-radius: 7em;
      border-top-right-radius: 7em;

    }

    #lock:after {
      content: "";
      box-sizing: border-box;
      position: absolute;
      border: 1em solid #2f4f4f;
      width: 2em;
      height: 8em;
      border-radius: 2.5em;

      margin-left: -7em;

    }

    #submit:hover

  }

</style>

</head>

<body>
<!-- partial:index.partial.html -->






<div class="page">
  <button th:onclick="|location.href='@{/}'|"    class="btn btn-outline-warning btn-lg" style="position: absolute; bottom: 90%; left: 93%"> HOME </button>
  <div class="container" style="margin:0px auto; z-index: 1">
    <div class="left">
      <div class="login typing-txt" style=" font-size: xx-large; margin-left: 80px ;line-height: 55px; font-family: 'Cooper Black';color: #565e64 ">
       <ul >
         <li> 만나서 반가워요</li>
         <li>お会いできて嬉しいです。</li>
         <li>Hej!</li>
         <li>I'm so glad you came!</li>
         <li>धन्यवाद</li>Namaste
         <li>Namaste</li>
         <li>Guten Tag</li>
         <li>Ciao</li>
       </ul>
      </div>

      <div class="typing" style=" font-size: xx-large; margin-top: 20px; color: #ffc720; text-shadow: #212529 1px 1px;" >
        <ul>
          <li></li>
          <li></li>
          <li></li>
          <li></li>
          <li></li>
          <li></li>
          <li></li>
          <li></li>
        </ul>
      </div>


      <div class="eula"></div>
    </div>
    <div class="right">
      <svg viewBox="0 0 320 480">
        <defs>
          <linearGradient>
                  inkscape:collect="always"
                  id="linearGradient"
                  x1="13"
                  y1="193.49992"
                  x2="307"
                  y2="193.49992"
                  gradientUnits="userSpaceOnUse">
            <stop
                    style="stop-color:#ff00ff;"
                    offset="0"
                    id="stop876" />
            <stop
                    style="stop-color:#ff0000;"
                    offset="1"
                    id="stop878" />
          </linearGradient>
        </defs>
        <path d="m 40,120.00016 239.99984,-3.2e-4 c 0,0 24.99263,0.79932 25.00016,35.00016 0.008,34.20084 -25.00016,35 -25.00016,35 h -239.99984 c 0,-0.0205 -25,4.01348 -25,38.5 0,34.48652 25,38.5 25,38.5 h 239.99984 c 0,0 24.99263,0.79932 25.00016,35.00016 0.008,34.20084 -25.00016,35 -25.00016,35 h -239.99984 c 0,-0.0205 -25,4.01348 -25,38.5 0,34.48652 25,38.5 25,38.5 h 215 c 0,0 20,-0.99604 20,-25 0,-24.00396 -20,-25 -20,-25 h -190 c 0,0 -20,1.71033 -20,25 0,24.00396 20,25 20,25"/>
      </svg>



<!--로그인 창 가방 손잡이 구현-->
      <div id="lock" style="position: absolute; transition: 3s;  z-index: 2; left: 76%; top: 29%" ></div>
      <!---->



      <div class="form">

        <div id="signupForm" style="margin-top: -10px; margin-left: 10px;  z-index: 4">
          <label for="email">메일주소</label>
          <div>
          <div id="emailCheckResult">
            <input type="email" id="email" class="form-control my-input" placeholder="email" name="email"  style="" required>
            <button type="button" id="checkDuplicateEmail" class="btn btn-sm w-100 btn-outline-secondary " style="margin-top: 1px; color: #FFFFFF;">중복체크</button>
             </div>
            <label for="password1">비밀번호</label>
            <input type="password" id="password1" class="form-control my-input" placeholder="password" name="password1" required>
            <label for="password2">비밀번호 재확인</label>
            <input type="password" id="password2" class="form-control my-input" placeholder="password" name="password2" required>
            <label for="name">이름</label>
            <input type="text" id="name" class="form-control my-input" placeholder="name" name="name" required>
            <div  id="submit" type="button" class="btn btn-outline-secondary w-75" style="color: #FFFFFF; margin-left: 14%; margin-top: 25%;" > 회원가입
            </div>

          </div>
        </div>

      </div>
    </div>
  </div>




<script>
  $(function(){
    init();
  })

  function init(){
  }
      $('#submit').click(function (){
        console.log('signupForm start')
        var email = $('#email').val();
        var password1 = $('#password1').val();
        var password2= $('#password2').val();
        var name = $('#name').val();

        if (!/^[A-Za-z0-9]+@[A-Za-z0-9]+\.[A-Za-z]{2,}$/.test(email)) {
          alert("올바른 이메일 주소를 입력하세요.");
          return false;
        }
        if (!/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/.test(password1)) {
          alert("비밀번호는 최소 8자, 하나 이상의 숫자와 특수 문자를 포함해야 합니다.");
          return false;
        }
        if (!/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/.test(password2)) {
          alert("비밀번호는 최소 8자, 하나 이상의 숫자와 특수 문자를 포함해야 합니다.");
          return false;
        }
        if (password1 !== password2) {
          alert("비밀번호가 일치하지 않습니다.");
          return false;
        }
        if (!/^[A-Za-z가-힣]{2,30}$/.test(name)) {
          alert("이름은 2-30자의 문자여야 합니다.");
          return false;
        }

        var formData = {
          email: email,
          password1: password1,
          password2: password2,
          name: name
        };

        $.ajax({
          url: '/signup',
          type: 'POST',
          contentType: 'application/json',
          data: JSON.stringify(formData),
          success: function (data) {
            alert(data.message || "회원가입이 완료되었습니다. 로그인 해주세요.");
            window.location.href = '/signin';
          },
          error: function (error) {
            console.error('Error:', error);
            var errorMsg = error.responseJSON?.message || error.responseText;
            alert("회원가입에 실패하였습니다. " + errorMsg);
          }
        });
      })

    $('#checkDuplicateEmail').on('click', function() {
      var email = $('#email').val();
      if (email) {
        $.ajax({
          url: '/check-duplicate?email=' + encodeURIComponent(email),
          type: 'GET',
          success: function(data) {
            if (data.isDuplicate) {
              alert("중복된 이메일입니다.");
            } else {
              alert("사용 가능한 이메일입니다.");
            }
          },
          error: function(xhr, status, error) {
            console.error('Ajax 요청 실패:', xhr, status, error);
            // 서버로부터 에러 응답을 받았을 때의 처리
            var errorMessage = xhr.responseJSON.errorMessage;
            alert("에러 발생: " + errorMessage);
          }
        });
      } else {
        alert("이메일을 입력해주세요.");
      }
    });
  </script>




  <script src="http://code.jquery.com/jquery-3.1.0.js"></script>
  <script>
    $(document).ready(function () {
      $('#submit').hover(function () {

        $('#lock').css('left','93%');
      }, function () {

        $('#lock').css('left','76%');
      },100);
    });
  </script>


  <script>
    $(document).ready(function () {
      $('#checkDuplicateEmail').hover(function () {

        $('#lock').css('left','90%');
      },
              function () {

        $('#lock').css('left','76%');
      },100);
    });
  </script>





  <script>


    var typingBool = false;
    var typingIdx=0;
    var liIndex = 0;
    var liLength = $(".typing-txt>ul>li").length;


    var typingTxt = $(".typing-txt>ul>li").eq(liIndex).text();


    typingTxt=typingTxt.split("");

    if(typingBool==false){
      typingBool=true;
      var tyInt = setInterval(typing,100);
    }

    function typing(){
      $(".typing ul li").removeClass("on");
      $(".typing ul li").eq(liIndex).addClass("on");


      if(typingIdx<typingTxt.length){
        $(".typing ul li").eq(liIndex).append(typingTxt[typingIdx]);
        typingIdx++;
      } else{
        if(liIndex<liLength-1){

          liIndex++;

          typingIdx=0;
          typingBool = false;
          typingTxt = $(".typing-txt>ul>li").eq(liIndex).text();


          clearInterval(tyInt);


          setTimeout(function(){

            tyInt = setInterval(typing,100);
          },1000);
        } else if(liIndex==liLength-1){


          clearInterval(tyInt);


          setTimeout(function(){

            typingBool = false;
            liIndex=0;
            typingIdx=-0;


            typingTxt = $(".typing-txt>ul>li").eq(liIndex).text();

            $(".typing ul li").html("")

            //반복시작
            tyInt = setInterval(typing,100);
          }, 1000);


        }
      }
    }


  </script>








</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>

</body>
</html>
